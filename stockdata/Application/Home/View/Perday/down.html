<extend name="Public:base" />

<block name="main-page">
    <div class="main-page">
        <!--grids-->
        <div class="grids">
            <div class="progressbar-heading grids-heading">
                <h2>每日涨跌排名</h2>
            </div>
            <div class="panel panel-widget">
                <div class="tables">
                    <div style="margin-bottom: 10px;">
                        <form id="type_form" method="get">
                            <div style="float:left;"><h4>{$today}（跌幅排名）</h4></div>
                            <div style="float:left;margin:0px 50px;">
                                <select id="range" name="range" style="margin: 0px 5px;">
                                    <option value="0">全部</option>
                                    <option value="1" <if condition="$Think.get.range eq 1">selected="selected"</if>>-8%~-10%</option>
                                    <option value="2" <if condition="$Think.get.range eq 2">selected="selected"</if>>-5%~-8%</option>
                                    <option value="3" <if condition="$Think.get.range eq 3">selected="selected"</if>>-2%~-5%</option>
                                </select>
                                <input type="submit" id="confirm" value="   确 定   " style="margin: 0px 5px;">
                            </div>
                            <div style="float:right"></div>
                            <div style="clear: both;"></div>
                        </form>
                    </div>
                    <table class="table table-bordered" style="font-size: 14px;">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Date&nbsp;</span><span><if condition="$Think.get.sort eq 'Date'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Code&nbsp;</span><span><if condition="$Think.get.sort eq 'Code'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th>Industry</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>V2ma5d&nbsp;</span><span><if condition="$Think.get.sort eq 'V2ma5d'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>V2ma10d&nbsp;</span><span><if condition="$Think.get.sort eq 'V2ma10d'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>V2ma20d&nbsp;</span><span><if condition="$Think.get.sort eq 'V2ma20d'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th>Close</th>
                            <th>Bvps</th>
                            <th>Pe</th>
                            <th>Profits_yoy</th>
                            <th>Mbrg</th>
                            <th>TimeToMarket</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>P_change&nbsp;</span><span><if condition="!isset($_GET['sort'])">↓<elseif condition="$Think.get.sort eq 'P_change'"/><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                        </tr>
                        </thead>
                        <tbody>
                        <foreach name="list" item="vo">
                            <tr>
                                <td><a href="{:U('Detail/index',array('code'=>$vo['code']))}">{$vo.name}</a></td>
                                <td>{$vo.date}</td>
                                <td><a href="{:U('Detail/index',array('code'=>$vo['code']))}">{$vo.code}</a></td>
                                <td>{$vo.industry}</td>
                                <td>{$vo.v2ma5d|round=###,2}</td>
                                <td>{$vo.v2ma10d|round=###,2}</td>
                                <td>{$vo.v2ma20d|round=###,2}</td>
                                <td>{$vo.close}</td>
                                <td>{$vo.bvps}</td>
                                <td>{$vo.pe}</td>
                                <td>{$vo.profits_yoy}</td>
                                <td>{$vo.mbrg|round=###,2}</td>
                                <td>{$vo.timetomarket|format_date}</td>
                                <td>{$vo.p_change|round=###,2}%</td>
                            </tr>
                        </foreach>
                        </tbody>
                    </table>
                    <div style="float:left;"></div><div class="manu" style="float:right;">{$page}</div><div style="clear: both;"></div>
                    <script type="text/javascript">
                        $(function() {
                            $('#confirm').click(function(e) {
                                var range = $('#range').val();
                                var url = '__URL__';
                                url += '/down?range=' + range;

                                window.location.href = url;

                                return e.preventDefault();
                            });

                            $('.tables th[style]').click(function() {
                                var desc = $(this).children(':eq(1)').text();
                                var sort = $.trim($(this).children(':eq(0)').text());

                                var params = 'down?sort=' + sort;
                                if(desc == '' || desc == '↑') {
                                    params += '&desc=1';
                                } else {
                                    params += '&desc=0';
                                }

                                var range = $('#range').val();
                                if(range > 0) {
                                    params += '&range=' + range;
                                }

                                window.location.href = "{:U('" + params + "')}";
                            });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!--//grids-->

    </div>
</block>