<extend name="Public:base" />

<block name="main-page">
    <div class="main-page">
        <!--grids-->
        <div class="grids">
            <div class="progressbar-heading grids-heading">
                <h2>计算模型（{$today}）</h2>
            </div>
            <div class="panel panel-widget">
                <div class="tables">
                    <h4>成交量突破5d</h4>
                    <table class="table table-bordered" style="font-size: 14px;">
                        <thead style="font-size: 10px;">
                        <tr>
                            <th>Choose</th>
                            <th>Name</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Date&nbsp;</span><span><if condition="!isset($_GET['sort'])">↓<elseif condition="$Think.get.sort eq 'Date'"/><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th>Code</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Man_date&nbsp;</span><span><if condition="$Think.get.sort eq 'Man_date'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th>Cost_price</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Vol_break_5d&nbsp;</span><span><if condition="$Think.get.sort eq 'Vol_break_5d'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Vol_break_10d&nbsp;</span><span><if condition="$Think.get.sort eq 'Vol_break_10d'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Vol_break_20d&nbsp;</span><span><if condition="$Think.get.sort eq 'Vol_break_20d'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>P_change&nbsp;</span><span><if condition="$Think.get.sort eq 'P_change'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Percent&nbsp;</span><span><if condition="$Think.get.sort eq 'Percent'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Cur_per&nbsp;</span><span><if condition="$Think.get.sort eq 'Cur_per'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th>Close</th>
                            <th>Bvps</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Pe&nbsp;</span><span><if condition="$Think.get.sort eq 'Pe'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                            <th>Profits_yoy</th>
                            <th>Mbrg</th>
                            <th>TimeToMarket</th>
                            <th style="cursor:pointer;color:#67D3E0;"><span>Yield_rate&nbsp;</span><span><if condition="$Think.get.sort eq 'Yield_rate'"><if condition="$Think.get.desc eq 1">↓<else />↑</if></if></span></th>
                        </tr>
                        </thead>
                        <tbody>
                        <foreach name="list" item="vo">
                            <tr>
                                <td><label><input name="choose" type="checkbox" value="{$vo.id}" />&nbsp;&nbsp;删除</label></td>
                                <td><a href="{:U('Detail/index',array('code'=>$vo['code']))}">{$vo.name}</a></td>
                                <td>{$vo.date}</td>
                                <td><a href="{:U('Detail/index',array('code'=>$vo['code']))}">{$vo.code}</a></td>
                                <td>{$vo.man_date}</td>
                                <td>{$vo.cost_price}</td>
                                <td>{$vo.vol_break_5d|round=###,2}</td>
                                <td>{$vo.vol_break_10d|round=###,2}</td>
                                <td>{$vo.vol_break_20d|round=###,2}</td>
                                <td <if condition="$vo.p_change egt 3">style="color: red"</if>>{$vo.p_change|round=###,2}%</td>
                                <td>{$vo.percent|round=###,2}</td>
                                <td>{$vo.cur_per|round=###,2}</td>
                                <td>{$vo.close}</td>
                                <td>{$vo.bvps}</td>
                                <td>{$vo.pe}</td>
                                <td>{$vo.profits_yoy}</td>
                                <td>{$vo.mbrg|round=###,2}</td>
                                <td>{$vo.timetomarket|format_date}</td>
                                <td>{$vo.yield_rate|round=###,2}%</td>
                            </tr>
                        </foreach>
                        </tbody>
                    </table>
                    <input id="delete" type="button" value="   删 除   " style="float:left;"/><div class="manu" style="float:right;">{$page}</div><div style="clear: both;"></div>
                    <script type="text/javascript">
                        $(function() {
                            $('.tables th[style]').click(function() {
                                var desc = $(this).children(':eq(1)').text();
                                var sort = $.trim($(this).children(':eq(0)').text());

                                var params = 'volumeBreak5d?sort=' + sort;
                                if(desc == '' || desc == '↑') {
                                    params += '&desc=1';
                                } else {
                                    params += '&desc=0';
                                }

                                window.location.href = "{:U('" + params + "')}";
                            });

                            $('#delete').click(function() {
                                var chooseArr = [];
                                $('input[name=choose]').each(function() {
                                    if($(this).prop('checked')) {
                                        chooseArr.push($(this).val());
                                    }
                                });
                                if(chooseArr.length == 0) {
                                    alert('您还没有做出任何选择！');
                                    return false;
                                } else {
                                    var chooseStr = chooseArr.join(',');
                                    window.location.href = "{:U('Model/delete')}?ids="+chooseStr;
                                }
                            });
                        });
                    </script>
                </div>
            </div>
        </div>
        <!--//grids-->

    </div>
</block>